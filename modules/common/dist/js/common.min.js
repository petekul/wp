var app=angular.module("SSO.url",["ui.router"]);angular.module("SSO.url").service("originService",function(t,e){function n(){var t={};o.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,n,o){t[n]=o});return t}var o,r;e.defer();return{storeOrigin:function(){o=document.URL;var t=n().backUrl;t||(t="http://www.mybusiness.worldpay.com"),r=t,console.log(r+" has been stored")},getOrigin:function(){return o},getURL:function(){return r}}}),(app=angular.module("SSO.url")).controller("urlController",["$scope","$stateParams","$state","urlService",function(t,e,n,o){o.loadURLs().then(function(e){t.logoutURL=o.getLogoutURL()},function(t){void 0==t.status?n.go("app.error",{errormsg:t.status}):n.go("app.error",{errormsg:t.message})});var r=document.URL;""==r&&(r="http://ukdc2-tc-g1wxs08.wpds.worldpaytd.local:7777/sso/index.html?backUrl=http%3A%2F%2Fmybusiness.wpds.worldpaytd.local%3A7778%2Fmbd.html"),o.storeOrigin(r)}]),angular.module("SSO.url").service("urlService",["$http","$q",function(t,e){function n(){var t={};o.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,n,o){t[n]=o});return t}var o,r,a=e.defer(),i={};return{loadURLs:function(){var n=t.get("/sso/modules/common/index/urls.json");return e.all([n]).then(function(t){i=t[0].data,a.resolve()}),a.promise},getURLs:function(){return i},getURL:function(t){return t.includes("config")||(t+="test"),i.filter(function(e){return e.urlName===t})[0].url},getDefaultURL:function(){return i[0].url},getLogoutURL:function(){return"/logout?end_url="+i[0].url},storeOrigin:function(t){o=t;var e=n().backUrl;r=decodeURIComponent(e)},getOrigin:function(){return o},getBackURL:function(){return r}}}]);var app=angular.module("SSO.analytics",[]);!function(){var t=function(t){!function(t,e,n,o,r,a,i){t.GoogleAnalyticsObject=r,t[r]=t[r]||function(){(t[r].q=t[r].q||[]).push(arguments)},t[r].l=1*new Date,a=e.createElement(n),i=e.getElementsByTagName(n)[0],a.async=1,a.src="//www.google-analytics.com/analytics.js",i.parentNode.insertBefore(a,i)}(window,document,"script",0,"ga"),ga("create",t,"none")};angular.module("SSO.analytics").factory("analyticsService",["analyticsConfigService","$location","$http","$timeout",function(e,n,o,r){function a(t){s?s=!1:t||"function"==typeof f24_trackPage&&f24_trackPage(encodeURIComponent(document.location))}var i=angular.noop,u=[],s=!0,l={};e.loadAnalyticsConfig().then(function(e){l=e.data,t(l.googleAnalyticsID)},function(t){}),i=function(t,e){var o=n.path();angular.isDefined(t)&&(o.length>0&&"/"!==o[o.length-1]&&(o+="/"),o+=t),u.indexOf(o)>-1||r(function(){c(e,"googleAnalytics")&&ga("send","pageview",{page:o}),c(e,"f24")&&a(t)},200,!1)};var c=function(t,e){return!t||t&&t[e]};return{track:i,enableAll:function(){u=[]},disable:function(t){u.push(t)}}}])}(),function(){"use strict";angular.module("SSO.analytics").service("analyticsConfigService",function(t,e){return{loadAnalyticsConfig:function(){return t.get("views/assets/analytics/config/config.json")}}})}();var app=angular.module("SSO.sessionIdle",["SSO.url"]);(app=angular.module("SSO.sessionIdle")).directive("sessionIdle",["idleService","urlService",function(t,e){return{templateUrl:"/sso/modules/common/components/session-idle/templates/sessionIdle.tmpl.html",link:function(n,o,r){t.loadConfig(),n.yes=function(){e.loadURLs().then(function(e){t.startTimer()})},n.no=function(){t.logOut()},$("#idleModal").on("hidden.bs.modal",function(e){t.startTimer(),t.hideModal()})}}}]),angular.module("SSO.sessionIdle").service("idleService",["$http","$q","$state","urlService",function(t,e,n,o){var r=0,a=900,i=(e.defer(),function(){$("#idleModal").is(":hidden")&&$("#idleModal").modal("show")}),u=function(){$(".modal-backdrop").remove(),$("#idleModal").modal("hide")},s=function(){clearInterval(r)};return{loadConfig:function(){t.get("/sso/modules/common/components/session-idle/idle.conf.json").then(function(t){a=parseFloat(t.data.timeoutDuration)})},startTimer:function(){var t=(new Date).getTime(),e="0.0";s(),r=setInterval(function(){var o=(new Date).getTime()-t;e=Math.floor(o/100)/10,Math.round(e)==e&&(e+=".0"),e>a-60&&(i(),e>a&&(u(),n.go("app.timeout"),s()))},100)},logOut:function(){window.location.href="/logout",s()},timeOut:function(){var t="/logout"+o.getDefaultURL(),e=-1===t.indexOf("?")?"?":"&";window.location.href=t+e+"p_error_code=SSO-1"},hideModal:u}}]),(app=angular.module("SSO.timeout",[])).controller("timeoutController",["$scope",function(t){t.ok=function(){document.location.href="/logout"}}]),angular.module("SSO.errorpage",["SSO.url"]),angular.module("SSO.errorpage").service("errorService",["$http","$q",function(t,e){return{loadErrorConfig:function(){return t.get("views/error-pages/configs/errorconfig.json")}}}]),(app=angular.module("SSO.errorpage")).controller("errorController",["$scope","$sce","errorService",function(t,e,n){t.queryParams={},t.status=document.location.href,t.statusTitle="Oops. Something went wrong",t.statusInfo="An error occurred whilst processing your request. Please refresh the page or try again later.",t.errors=[],function(){window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,n,o){t.queryParams[n]=o});t.queryParams}(),t.status=t.queryParams.error_code,n.loadErrorConfig().then(function(t){this.errors=t.data,this.status||(this.status=""),this.statusInfo=this.errors[this.errors.map(t=>t.status).indexOf(this.status.toString())],this.statusInfo||(this.statusInfo=this.errors[0]),this.statusInfo.statusMsg=e.trustAsHtml(this.statusInfo.statusMsg)}.bind(t),function(t){console.log(t.statusText)}),t.ok=function(){console.log("ok")}}]);